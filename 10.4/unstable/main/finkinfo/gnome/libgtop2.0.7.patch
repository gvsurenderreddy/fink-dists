diff -uNr libgtop-2.14.9/configure.in libgtop-2.14.9-new/configure.in
--- libgtop-2.14.9/configure.in	2007-05-08 11:43:21.000000000 -0400
+++ libgtop-2.14.9-new/configure.in	2007-05-19 10:43:37.000000000 -0400
@@ -411,6 +411,7 @@
 sysdeps/solaris/Makefile
 sysdeps/aix/Makefile
 sysdeps/bsd/Makefile
+sysdeps/darwin/Makefile
 src/Makefile
 src/daemon/Makefile
 src/inodedb/Makefile
diff -uNr libgtop-2.14.9/include/glibtop/version.h libgtop-2.14.9-new/include/glibtop/version.h
--- libgtop-2.14.9/include/glibtop/version.h	2007-05-08 11:43:14.000000000 -0400
+++ libgtop-2.14.9-new/include/glibtop/version.h	2007-05-19 10:43:37.000000000 -0400
@@ -24,7 +24,7 @@
 
 #include <glibtop.h>
 
-#define LIBGTOP_VERSION_STRING "Libgtop %s server version %s (%u,%u,%u,%u)."
+#define LIBGTOP_VERSION_STRING "Libgtop %s server version %s (%lu,%lu,%lu,%lu)."
 
 G_BEGIN_DECLS
 
diff -uNr libgtop-2.14.9/lib/open.c libgtop-2.14.9-new/lib/open.c
--- libgtop-2.14.9/lib/open.c	2007-05-08 11:43:19.000000000 -0400
+++ libgtop-2.14.9-new/lib/open.c	2007-05-19 10:43:37.000000000 -0400
@@ -147,7 +147,7 @@
 
 		if (nbytes != size)
 			glibtop_error_r (server,
-					 "Requested %u bytes but got %u.",
+					 "Requested %lu bytes but got %lu.",
 					 size, nbytes);
 
 		glibtop_read_l (server, nbytes, buffer);
diff -uNr libgtop-2.14.9/libgtop-sysdeps.m4 libgtop-2.14.9-new/libgtop-sysdeps.m4
--- libgtop-2.14.9/libgtop-sysdeps.m4	2007-05-08 11:43:21.000000000 -0400
+++ libgtop-2.14.9-new/libgtop-sysdeps.m4	2007-05-19 10:43:37.000000000 -0400
@@ -89,8 +89,14 @@
 	  libgtop_sysdeps_dir=aix
 	  libgtop_use_machine_h=yes
 	  libgtop_need_server=yes
+	  libgtop_postinstall='chgrp kmem $(DESTDIR)$(bindir)/libgtop_server2 && chmod 6755 $(DESTDIR)/$(bindir)/libgtop_server2'
+	  ;;
+	darwin*)
+	  libgtop_sysdeps_dir=darwin
+	  libgtop_use_machine_h=yes
+	  libgtop_need_server=yes
 	  libgtop_have_sysinfo=yes
-	  libgtop_postinstall='chgrp system $(bindir)/libgtop_server && chmod g+s $(bindir)/libgtop_server2'
+	  libgtop_postinstall='chgrp sys $(DESTDIR)$(bindir)/libgtop_server2 && chmod g+s $(DESTDIR)$(bindir)/libgtop_server2'
 	  ;;
 	*)
 	  if test x$hacker_mode = xyes ; then
diff -uNr libgtop-2.14.9/ltmain.sh libgtop-2.14.9-new/ltmain.sh
--- libgtop-2.14.9/ltmain.sh	2006-03-11 14:40:23.000000000 -0500
+++ libgtop-2.14.9-new/ltmain.sh	2007-05-19 10:43:37.000000000 -0400
@@ -2545,7 +2545,7 @@
 	   { test "$use_static_libs" = no || test -z "$old_library"; }; then
 	  if test "$installed" = no; then
 	    notinst_deplibs="$notinst_deplibs $lib"
-	    need_relink=yes
+	    need_relink=no
 	  fi
 	  # This is a shared library
 
@@ -4023,8 +4023,24 @@
 	  eval test_cmds=\"$archive_expsym_cmds\"
 	  cmds=$archive_expsym_cmds
 	else
+	  if test "x$verstring" = "x0.0"; then
+	      tmp_verstring=
+	    else
+	      tmp_verstring="$verstring"
+	    fi
+	    save_deplibs="$deplibs"
+	    for conv in $convenience; do
+	      tmp_deplibs=
+	      for test_deplib in $deplibs; do
+	        if test "$test_deplib" != "$conv"; then
+	          tmp_deplibs="$tmp_deplibs $test_deplib"
+	        fi
+	      done
+	      deplibs="$tmp_deplibs"
+	    done
 	  eval test_cmds=\"$archive_cmds\"
 	  cmds=$archive_cmds
+     deplibs="$save_deplibs"
 	  fi
 	fi
 
diff -uNr libgtop-2.14.9/src/daemon/Makefile.am libgtop-2.14.9-new/src/daemon/Makefile.am
--- libgtop-2.14.9/src/daemon/Makefile.am	2007-05-08 11:43:14.000000000 -0400
+++ libgtop-2.14.9-new/src/daemon/Makefile.am	2007-05-19 10:51:06.000000000 -0400
@@ -21,7 +21,7 @@
 				  -DLIBGTOP_COMPILE_MACHINE="\"`uname -m`\""
 
 if NEED_LIBGTOP
-suid_sysdeps			= $(top_builddir)/sysdeps/@sysdeps_dir@/libgtop_sysdeps_suid-2.0.la
+suid_sysdeps			= $(top_builddir)/sysdeps/@sysdeps_dir@/libgtop_sysdeps_suid-2.0.la $(top_builddir)/sysdeps/@sysdeps_dir@/libgtop_sysdeps-2.0.la 
 suid_common			= $(top_builddir)/sysdeps/common/libgtop_suid_common-2.0.la
 else
 suid_sysdeps			=
@@ -45,10 +45,12 @@
 
 libgtop_server2_SOURCES		= server.c slave.c io.c version.c daemon.h
 libgtop_server2_LDADD		= $(GLIB_LIBS) -lpopt $(top_builddir)/sysdeps/@sysdeps_dir@/libgtop_sysdeps_suid-2.0.la \
-				  $(top_builddir)/sysdeps/common/libgtop_suid_common-2.0.la
+				  $(top_builddir)/sysdeps/@sysdeps_dir@/libgtop_sysdeps-2.0.la \
+				  $(top_builddir)/sysdeps/common/libgtop_suid_common-2.0.la \
+				  $(top_builddir)/lib/libgtop-2.0.la
 
 EXTRA_DIST			= server_config.h.in server_config.pl
 
 install-exec-hook:
-	-@libgtop_postinstall@
+	@libgtop_postinstall@
 
diff -uNr libgtop-2.14.9/src/daemon/main.c libgtop-2.14.9-new/src/daemon/main.c
--- libgtop-2.14.9/src/daemon/main.c	2007-05-08 11:43:14.000000000 -0400
+++ libgtop-2.14.9-new/src/daemon/main.c	2007-05-19 10:43:37.000000000 -0400
@@ -52,7 +52,7 @@
 			glibtop_server_features);
 
     if (enable_debug)
-	syslog_message (LOG_DEBUG, "SIZEOF: %u - %u - %u - %u - %u - %u",
+	syslog_message (LOG_DEBUG, "SIZEOF: %lu - %lu - %lu - %lu - %lu - %lu",
 			sizeof (glibtop_command), sizeof (glibtop_response),
 			sizeof (glibtop_mountentry), sizeof (glibtop_union),
 			sizeof (glibtop_sysdeps),
diff -uNr libgtop-2.14.9/sysdeps/Makefile.am libgtop-2.14.9-new/sysdeps/Makefile.am
--- libgtop-2.14.9/sysdeps/Makefile.am	2007-05-08 11:43:18.000000000 -0400
+++ libgtop-2.14.9-new/sysdeps/Makefile.am	2007-05-19 10:43:37.000000000 -0400
@@ -2,4 +2,4 @@
 SUBDIRS			= common @sysdeps_dir@
 
 DIST_SUBDIRS		= bsd common linux osf1 \
-			  stub stub_suid sun4 freebsd solaris aix
+			  stub stub_suid sun4 freebsd solaris aix darwin
