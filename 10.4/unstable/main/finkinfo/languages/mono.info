Package: mono
Version: 1.2.5
Revision: 1021
Description: .NET-compatible CIL engine
Type: java(1.4)
License: LGPL
Maintainer: Benjamin Reed <mono@fink.racoonfink.com>

Depends: <<
	libgettext3-shlibs,
	system-java14
<<
BuildDepends: <<
	atk1,
	cairo (>= 1.2-1),
	expat1,
	fink (>= 0.26.0-1),
	fontconfig2-dev,
	freetype219,
	gettext-tools,
	glib2-dev (>= 2.12.0-1),
	glitz (>= 0.4.4-1),
	libgettext3-dev,
	libiconv-dev,
	libicu32-dev,
	libpixman1 (>= 0.1.5-1),
	libpng3,
	pkgconfig,
	system-java14-dev
<<
BuildConflicts: libicu26-dev, libicu28-dev, libicu30-dev
Replaces: %N-dev (<< %v-%r)

CustomMirror: RangerMirror
Source: http://go-mono.com/sources/%n/%n-%v.tar.bz2
Source-MD5: 03a6d15fbf447a7807cc402dc8f64036
PatchScript: sed -e 's,@FINKPREFIX@,%p,g' %a/%n.patch | patch -p1

SetCPPFLAGS: -I%p/include
SetLDFLAGS: -bind_at_load
SetLIBS: -L%p/lib
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
ConfigureParams: --mandir=%p/share/man --sysconfdir=%p/etc --with-icu=yes --with-preview=yes --disable-dependency-tracking CFLAGS="-Os" CXXFLAGS="-Os"
CompileScript: <<
#!/bin/sh -ex

	ulimit -n unlimited
	export lt_cv_sys_max_cmd_len=65536
	perl -pi -e 's/hardcode_direct=yes/hardcode_direct=no/g; s/need_relink=yes/need_relink=no/g' configure ltmain.sh
	./configure %c --with-jdk=$JAVA_HOME
	make -j1
<<

InstallScript: <<
#!/bin/sh -ex

	ulimit -n unlimited || :
	make -j1 install DESTDIR="%d"
<<
DocFiles: AUTHORS COPYING* ChangeLog NEWS README
RuntimeVars: MONO_PATH: "%p/lib:/usr/lib"
SplitOff: <<
	Package: %N-shlibs
	Depends: <<
		cairo-shlibs (>= 1.2.2-1001),
		glib2-shlibs (>= 2.12.0-1),
		macosx (>= 10.4.3-1)
	<<
	Replaces: %N (<< %v-%r)
	Files: <<
		lib/libmono-profiler-*.0*.dylib
		lib/libmono.0*.dylib
	<<
	Shlibs: <<
		%p/lib/libmono-profiler-aot.0.dylib 1.0.0 %n (>= 1.2.5-1)
		%p/lib/libmono-profiler-cov.0.dylib 1.0.0 %n (>= 1.2.5-1)
		%p/lib/libmono.0.dylib              1.0.0 %n (>= 1.2.5-1)
	<<
<<
SplitOff2: <<
	Package: %N-dev
	Depends: %N (>= %v-%r)
	Replaces: %N (<< %v-%r)
	BuildDependsOnly: true
	Files: <<
		include
		lib/*.a
		lib/*.la
		lib/libmono-profiler*.dylib
		lib/libmono.dylib
		lib/pkgconfig
	<<
<<
Shlibs: <<
	%p/lib/libMonoPosixHelper.dylib 0.0.0 %n (>= 1.2.5-1)
	%p/lib/libMonoSupportW.dylib    0.0.0 %n (>= 1.2.5-1)
	%p/lib/libikvm-native.dylib     0.0.0 %n (>= 1.2.5-1)
<<

ConfFiles: <<
	%p/etc/mono/1.0/DefaultWsdlHelpGenerator.aspx
	%p/etc/mono/1.0/machine.config
	%p/etc/mono/2.0/DefaultWsdlHelpGenerator.aspx
	%p/etc/mono/2.0/machine.config
	%p/etc/mono/browscap.ini
	%p/etc/mono/config
<<

Homepage: http://go-mono.com/
DescDetail: <<
The Mono runtime implements a JIT engine for the CIL virtual machine
(as well as a byte code interpreter, this is to quickly port it to
new systems), the class loader, the garbage collector, threading
system and metadata access libraries.
<<

